<div class="clr-row">
    <div class="clr-col-6">
        <span class="headline">measurement</span>
    </div>
    <div class="clr-col-6 button-column">
        <button class="btn btn-link btn-sm" (click)="templateFile()" *ngIf="!measurementUploaded">
            <clr-icon shape="download"></clr-icon> download template file
        </button>
    </div>
</div>

<div class="file-upload" *ngIf="!measurementUploaded">
    <div class="clr-row">
        <div class="clr-col-12">
            <ngx-dropzone accept=".xlsx" (change)="onSelect($event)">
                <ngx-dropzone-label>upload measurement</ngx-dropzone-label>
                <ngx-dropzone-preview *ngFor="let file of files" [removable]="true" (removed)="onRemove(file)">
                    <ngx-dropzone-label>{{file.name}}</ngx-dropzone-label>
                </ngx-dropzone-preview>
            </ngx-dropzone>
        </div>
    </div>
    <div class="clr-row">
        <div class="clr-col-12" *ngIf="files.length > 0">
            <button class="btn btn-primary" (click)="uploadFile()">upload</button>
        </div>
    </div>
</div>

<div class="clr-row" *ngIf="measurementUploaded" >
    <div class="clr-col-12" >
        <div class="card" >
            <div class="card-block" >
                <div class="card-text">
                    <div class="clr-row" >
                        <div class="clr-col-2">
                            <clr-radio-container>
                                <label>style</label>
                                <clr-radio-wrapper>
                                    <input type="radio" clrRadio value="point" [(ngModel)]="getMeasurement().plot.style" (change)="updateImage()" />
                                    <label>point chart</label>
                                </clr-radio-wrapper>
                                <clr-radio-wrapper>
                                    <input type="radio" clrRadio value="line" [(ngModel)]="getMeasurement().plot.style" (change)="updateImage()" />
                                    <label>line chart</label>
                                </clr-radio-wrapper>
                            </clr-radio-container>
                            <clr-toggle-container>
                                <label>replicates</label>
                                <clr-toggle-wrapper>
                                    <input type="checkbox" clrToggle [(ngModel)]="getMeasurement().plot.replicate1" (change)="updateImage()" />
                                    <label>replica 1</label>
                                </clr-toggle-wrapper>
                                <clr-toggle-wrapper>
                                    <input type="checkbox" clrToggle [(ngModel)]="getMeasurement().plot.replicate2" (change)="updateImage()" />
                                    <label>replica 2</label>
                                </clr-toggle-wrapper>
                                <clr-toggle-wrapper>
                                    <input type="checkbox" clrToggle [(ngModel)]="getMeasurement().plot.replicate3" (change)="updateImage()" />
                                    <label>replica 3</label>
                                </clr-toggle-wrapper>
                            </clr-toggle-container>
                        </div>
                        <div class="clr-col-9 plot-column">
                            <img [src]="measurementPlot">
                        </div>
                        <div class="clr-col-1 button-column">
                            <button class="btn btn-icon btn-link" (click)="deleteMeasurement()">
                                <clr-icon shape="trash" class="is-error"></clr-icon>
                            </button>
                        </div>
                    </div>

                    <div class="clr-row" >
                        <div class="clr-col-4">
                            <clr-input-container>
                                <label>reagent</label>
                                <input clrInput type="text" [(ngModel)]="getMeasurement().reagent" (change)="updateImage()" name="reagent"/>
                            </clr-input-container>
                        </div>
                        <div class="clr-col-4">
                            <clr-input-container>
                                <label>x value</label>
                                <input clrInput type="text" [(ngModel)]="getMeasurement().x_name" (change)="updateImage()" name="x_name"/>
                            </clr-input-container>
                            <clr-input-container>
                                <input clrInput type="text" [(ngModel)]="getMeasurement().x_unit" (change)="updateImage()" name="x_unit"/>
                            </clr-input-container>
                        </div>
                        <div class="clr-col-4">
                            <clr-input-container>
                                <label>y value</label>
                                <input clrInput type="text" [(ngModel)]="getMeasurement().y_name" (change)="updateImage()" name="y_name"/>
                            </clr-input-container>
                            <clr-input-container>
                                <input clrInput type="text" [(ngModel)]="getMeasurement().y_unit" (change)="updateImage()" name="y_unit"/>
                            </clr-input-container>
                        </div>
                    </div>

                    <div class="clr-row" >
                        <div class="clr-col-12">
                            <clr-textarea-container>
                                <label>notes</label>
                                <textarea clrTextarea [(ngModel)]="getMeasurement().notes" name="notes"></textarea>
                            </clr-textarea-container>
                        </div>
                    </div>
                    <div class="clr-row measurement-data" >
                        <div class="clr-col-12">
                            <clr-accordion>
                                <clr-accordion-panel>
                                  <clr-accordion-title>data</clr-accordion-title>
                                  <clr-accordion-content *clrIfExpanded>
                                    <table class="table table-noborder table-compact">
                                        <thead>
                                            <tr>
                                                <th class="left">x</th>
                                                <th class="left">replica 1</th>
                                                <th class="left">replica 2</th>
                                                <th class="left">replica 3</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let element of getMeasurement().replicates">
                                                <td class="left">{{element.x_value}}</td>
                                                <td class="left" *ngFor="let value of element.y_values">{{value}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                  </clr-accordion-content>
                                </clr-accordion-panel>
                            </clr-accordion>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
